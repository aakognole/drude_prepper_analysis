* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v3.1 on Oct, 02. 2020. JOBID=0166348994
* 

DIMENS CHSIZE 2000000 MAXRES 2000000

! Read topology and parameter files
stream toppar_drude.str

! Read PSF and Coordinates
open read unit 10 card name step2_drude.psf
read psf  unit 10 card

open read unit 10 card name step2_drude.crd
read coor unit 10 card

write coor pdb name step2_drude.pdb

stream step2_drude.str

!coor sdrude
!coor shake

SHAKE bonh param nofast -
      select  .not. type D*  end -
      select  .not. type D*  end

open read unit 10 card name crystal_image.str
CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
CRYSTAL READ UNIT 10 CARD
image byres xcen 0.0 ycen 0.0 zcen 0.0 sele resn SWM4 end

nbonds atom vatom switch vswitch bycb -
       ctonnb 10.0 ctofnb 12.0 cutnb 16.0 cutim 16.0 LRC -
       inbfrq -1 imgfrq -1 wmin 1.0 cdie eps 1.0 -
       ewald pmew fftx @fftx ffty @ffty fftz @fftz  kappa .34 spline order 6
energy

set EENER ?ENER !  - total potential energy
set EBOND ?BOND !  - bond (1-2) energy
set EANGL ?ANGL !  - angle (1-3) energy
set EDIHE ?DIHE !  - dihedral 1-4 energy
set EUREY ?UREY !  - additional 1-3 urey bradley energy
set EIMPR ?IMPR !  - improper planar of chiral energy
set ECMAP ?CMAP !  - 2D dihedral cross term energy correction map

calc ENONB = ?VDW + ?ELEC + ?IMNB + ?IMEL + ?EWKS + ?EWSE + ?EWEX
calc ETOTE = @EBOND + @EANGL +@EDIHE + @EUREY + @EIMPR + @ECMAP + @ENONB
calc ELRC = @EENER - @ETOTE
calc ENONB = ?VDW + ?ELEC + ?IMNB + ?IMEL + ?EWKS + ?EWSE + ?EWEX + @ELRC
calc ETOTE = @EBOND + @EANGL +@EDIHE + @EUREY + @EIMPR + @ECMAP + @ENONB
calc EVDW = ?VDW + ?IMNB
calc EELC = @ENONB - @EVDW

open write card unit 10 name ./charmm.ener.txt
write title unit 10
*BOND @EBOND
*ANGL @EANGL
*DIHE @EDIHE
*UREY @EUREY
*IMPR @EIMPR
*CMAP @ECMAP
*EVDW @EVDW
*ELEC @EELC
*DRUD 0
*OTH1 0
*TOTE @ETOTE
*

stop
